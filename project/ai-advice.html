<!-- ai-advice.html -->
<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI助言サービス</title>
    <link rel="stylesheet" href="style/base.css" />
    <link rel="stylesheet" href="style/ai-advice.css" />
    <link rel="icon" type="image/x-icon" sizes="32x32" href="assets/icons/favicon-32x32_v2.ico">
    <link rel="icon" type="image/x-icon" sizes="16x16" href="assets/icons/favicon-16x16_v2.ico">
</head>

<body class="ai-advice-page">
    <div class="background-image"></div>
    <header class="main-header" style="margin-bottom:0;">
        <div class="title-container">
            <h1><a href="index.html"><img src="assets/images/title.svg" alt="易経くじ" class="title-svg" /></a></h1>
        </div>
        <nav class="nav-menu" id="nav-menu">
            <ul>
                <li><a href="index.html" class="nav-link">易経くじ</a></li>
                <li><a href="about-iching.html" class="nav-link">易経とは</a></li>
                <li><a href="how-to.html" class="nav-link">占い方</a></li>
                <li><a href="hexagrams.html" class="nav-link">六十四卦</a></li>
                <li><a href="bagua.html" class="nav-link">八卦</a></li>
                <li><a href="how-to-read.html" class="nav-link">卦の見方</a></li>
                <li><a href="log.html" class="nav-link">ログ一覧</a></li>
            </ul>
        </nav>
        <div class="login-container">
            <button id="login-button" class="auth-button">Googleでログイン</button>
            <button id="logout-button" class="auth-button" style="display: none;">ログアウト</button>
        </div>
        <div class="auth-hamburger-wrapper">
            <div class="hamburger" id="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <div class="auth-icon-container">
                <img id="auth-icon" src="assets/icons/google-icon-1.svg" alt="Googleアカウント" class="auth-icon"
                    title="ログイン中 - タップでログアウト" />
            </div>
        </div>
    </header>

    <main class="ai-advice-container">
        <h1 style="text-align: center;">易断が導く道しるべ</h1>
        <div id="intro-text" class="intro-box"></div>

        <section class="question-section">
            <div id="chat-log" class="chat-log-container"></div>
            <form id="ai-detail-form">

                <!-- ステップ1: 名前入力 -->
                <div class="question-step">
                    <label for="user-name">あなたをなんとお呼びしましょうか？</label>
                    <input id="user-name" type="text" placeholder="例：たろう" />
                    <button type="button" class="next-btn">次へ</button>
                </div>

                <!-- ステップ2: 背景入力 -->
                <div class="question-step hidden">
                    <label id="label-topic" for="user-background">どんな背景や経緯がありましたか？</label>
                    <textarea id="user-background" rows="3" placeholder="例：その問題には家族の事情が絡んでいます"></textarea>
                    <button type="button" class="next-btn">次へ</button>
                </div>

                <!-- ステップ3: 感情入力 -->
                <div class="question-step hidden">
                    <label id="label-situation" for="user-situation">現在の状況・お気持ち</label>
                    <textarea id="user-situation" rows="3" placeholder="例：何回も試してもうまくいかないので、もう半分諦め気分だ。"></textarea>
                    <button type="button" class="next-btn">次へ</button>
                </div>

                <!-- ステップ4: メールアドレス -->
                <div class="question-step hidden">
                    <label for="user-email">メールアドレスを教えてください（PDF送付先）：</label>
                    <input type="email" id="user-email" name="email" required placeholder="例：example@example.com" />
                    <button type="button" class="next-btn">次へ</button>
                </div>

                <!-- ステップ5: その他 -->
                <div class="question-step hidden">
                    <label for="user-notes">助言を受けるにあたり、それ以外にも伝えておいた方がいいことがあればご自由にどうぞ：</label>
                    <textarea id="user-notes" name="notes" maxlength="200" placeholder="任意：背景や気になる点など"></textarea>

                    <button type="button" id="paymentButton" class="send-button">100円で助言を受ける</button>
                    <button type="button" id="testSendButton" class="send-button">💡 テスト送信（決済なし）</button>

                    <div id="sendingStatus" style="display:none; text-align:center; margin-top:10px;">
                        <span>送信中です...🌀</span>
                    </div>
                </div>
            </form>
        </section>
    </main>

    <footer>
        Iching — Book of Change ©2025
        <p><a href="feedback.html">📝 ご意見・ご要望はこちら</a></p>
    </footer>

    <div id="toast" class="toast"></div>
    <!-- Javascript読み込み -->
    <script src="firebase/env.js"></script>
    <script type="module" src="/firebase/firebase.js"></script>
    <script type="module" src="/firebase/auth.js"></script>
    <script type="module" src="ai-advice.js"></script>
    <script type="module" src="steps.js"></script>
    <script type="module" src="payment.js"></script>
</body>

</html>